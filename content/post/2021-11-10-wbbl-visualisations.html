---
title: '#WBBL visualisations'
author: Jacquie Tran
date: '2021-11-10'
slug: wbbl-visualisations
categories:
  - On-field analyses
tags:
  - women's sport
  - r stats
  - sports analytics
  - cricket
draft: yes
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>It’s been a thrilling #WBBL07 so far - the competition seems well-balanced, with every team boasting world-class athletes alongside the young guns who are the next wave of Australian talent coming through.</p>
<p>Coming off the back of the hotly contested Australia vs. India series, I have been glued to the TV. I thought I might as well turn my attention to another screen instead - my computer screen - and take a closer look at some key performances so far this season.</p>
<p>Here’s a little tour of some visualisations I’ve made recently using Women’s Big Bash League (WBBL) data.</p>
</div>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<p>I use a few custom functions to retrieve data from <a href="https://cricsheet.org">Cricsheet.org</a>, and I’m continuing to work on them over <a href="https://github.com/jacquietran/cricsheet">here</a>. <em>(Buyer beware: they work if you know the right sequence of actions and say some nice things in the general direction of your RStudio IDE.)</em></p>
<pre class="r"><code>library(here)
library(readr)
library(dplyr)
library(stringr)
library(showtext)
library(ggplot2)
library(gghighlight)
library(ggtext)
library(paletteer)
library(patchwork)</code></pre>
<pre class="r"><code># Fetch ball-by-ball data
wbbl_bbb &lt;- fetch_cricsheet_bbb(&quot;wbbl&quot;)

# Fetch match metadata
wbbl_match_info &lt;- fetch_cricsheet_match_info(&quot;wbbl&quot;)</code></pre>
<div id="alyssa-healys-wbbl-batting-record" class="section level2">
<h2>Alyssa Healy’s WBBL batting record</h2>
<p>What is there to say about Alyssa Healy that hasn’t already been written by a far better writer than I? (If you haven’t seen it, check out <a href="https://www.cricket.com.au/news/feature/alyssa-healy-australia-india-mitch-starc-vice-captain-sister-kareen-family-lanning-mott/2021-10-10">this recent feature article by Adam Burnett</a>.)</p>
<p>She’s a superstar at every level she plays at, so I wanted to visualise her production across seasons, compared to other batters in the WBBL.</p>
<div id="tidying-the-data" class="section level3">
<h3>Tidying the data</h3>
<p>On exploring the Cricsheet data, I noticed that there are only 10 matches from WBBL01 with ball-by-ball data, but there were 59 matches played in the 1st season of WBBL (per <a href="https://en.wikipedia.org/wiki/2015%E2%80%9316_Women%27s_Big_Bash_League_season">Wikipedia</a>).</p>
<p>Additionally, when I originally worked on this plot of <a href="https://twitter.com/jacquietran/status/1448534315202080773">Healy vs. the world</a>, it was mid-October and the first ball of #WBBL07 had yet to be bowled. Now, we are reproducing the chart as we are part-way through the current season, so the code below also omits data from any matches played so far in this 7th season.</p>
<pre class="r"><code># Data from 2015/16 (WBBL01) excluded due to only having 10 matches worth of data in the Cricsheet spreadsheet.
# Data from 2021/22 (WBBL07) excluded as season is currently in progress.
wbbl_bbb %&gt;%
  filter(!season %in% c(&quot;2015/16&quot;, &quot;2021/22&quot;)) -&gt; wbbl_bbb_tidy</code></pre>
<p>The ball-by-ball data hosted by Cricsheet provides a great starting point, but a little more tidying and wrangling is needed for the purposes of understanding batting performances across WBBL seasons.</p>
<p>In cricket broadcasts, batting average is probably the most common statistic that commentators will reference to highlight how well a player performs with willow in hand. Batting average is calculated by taking runs scored over a period of time and dividing it by the number of dismissals (e.g., )</p>
<p>Given the T20 format of the WBBL, I was more interested in</p>
<pre class="r"><code># Alyssa Healy compared to all players who have batted in 3+ innings in a season.
wbbl_bbb_tidy %&gt;%
  group_by(season, striker) %&gt;%
  summarise(
    innings_total = length(unique(match_id)),
    runs_off_bat_total = sum(runs_off_bat),
    balls_faced_total = length(ball),
    .groups = &quot;keep&quot;) %&gt;%
  mutate(
    runs_per_innings_avg = round(runs_off_bat_total / innings_total, 1),
    strike_rate = round(runs_off_bat_total / balls_faced_total * 100, 1)) %&gt;%
  filter(innings_total &gt; 2) -&gt; batting_per_season

# Flag Healy&#39;s per season records
batting_per_season %&gt;%
  mutate(
    is_healy = case_when(
      striker == &quot;AJ Healy&quot; ~ 1,
      TRUE                  ~ 0)) -&gt; batting_per_season_healy</code></pre>
<pre class="r"><code>font_add_google(&quot;Roboto Condensed&quot;, &quot;roboto_con&quot;)
font_add_google(&quot;Staatliches&quot;, &quot;staat&quot;)</code></pre>
<pre class="r"><code>showtext_auto()

p &lt;- ggplot(batting_per_season_healy,
            aes(x = season, y = runs_per_innings_avg,
                group = striker, colour = is_healy))
p &lt;- p + geom_line(size = 3, colour = paletteer_d(&quot;beyonce::X25&quot;)[5])
p &lt;- p + gghighlight(
  is_healy &gt; 0,
  label_key = striker,
  label_params = aes(
    size = 6, force_pull = 0.1, nudge_y = 10, label.size = 2,
    family = &quot;roboto_con&quot;, label.padding = 0.5,
    fill = paletteer_d(&quot;beyonce::X116&quot;)[4],
    colour = paletteer_d(&quot;beyonce::X25&quot;)[5]),
  unhighlighted_params = aes(size = 1),
  unhighlighted_colour = paletteer_d(&quot;beyonce::X73&quot;)[7])
p &lt;- p + labs(
  title = &quot;WBBL: Average runs scored per innings (3+ innings)&quot;,
  x = NULL, y = NULL,
  caption = &quot;**Source:** Cricsheet.org // **Plot:** @jacquietran&quot;)
p &lt;- p + theme_minimal()
p &lt;- p + theme(
  text = element_text(
    size = 18, family = &quot;roboto_con&quot;, colour = &quot;#FFFFFF&quot;),
  plot.title = element_text(family = &quot;staat&quot;, margin=margin(0,0,15,0)),
  plot.caption = element_markdown(size = NULL, margin=margin(15,0,0,0)),
  axis.text = element_text(colour = &quot;#FFFFFF&quot;),
  legend.position = &quot;none&quot;,
  panel.grid.major = element_line(linetype = &quot;dashed&quot;),
  panel.grid.minor = element_blank(),
  plot.background = element_rect(
      fill = paletteer_d(&quot;beyonce::X116&quot;)[3],
      colour = NA),
  panel.spacing = unit(2, &quot;lines&quot;),
  plot.margin = unit(c(0.5,0.5,0.5,0.5), &quot;cm&quot;))
plot_healy_per_season &lt;- p

plot_healy_per_season</code></pre>
<p><img src="/post/2021-11-10-wbbl-visualisations_files/figure-html/plot_healy_per_season-1.png" width="768" /></p>
</div>
</div>
<div id="dismissals-by-ball-number" class="section level2">
<h2>Dismissals by ball number</h2>
<pre class="r"><code># Create new variable for ball number in each over
ball_number_faced &lt;- wbbl_bbb_tidy %&gt;%
  mutate(
    ball_num_in_over = sub(&quot;.*\\.&quot;, &quot;&quot;, ball))

# Summarise number of balls faced of each ball number, per batter
ball_number_faced_summary &lt;- ball_number_faced %&gt;%
  group_by(ball_num_in_over, striker) %&gt;%
  summarise(balls_faced = n(), .groups = &quot;keep&quot;) %&gt;%
  ungroup()

# Dismissals by ball number
dismissals_by_ball_number &lt;- ball_number_faced %&gt;%
  select(ball_num_in_over, striker, wicket_type) %&gt;%
  filter(!is.na(wicket_type)) %&gt;%
  group_by(ball_num_in_over, striker) %&gt;%
  summarise(dismissals_n = n(), .groups = &quot;keep&quot;) %&gt;%
  ungroup()

# Merge data
dismissals_by_ball_number_summary &lt;- left_join(
  ball_number_faced_summary, dismissals_by_ball_number) %&gt;%
  tidyr::replace_na(list(dismissals_n = 0)) %&gt;%
  group_by(striker) %&gt;%
  mutate(total_balls_faced = sum(balls_faced)) %&gt;%
  ungroup() %&gt;%
  mutate(dismissals_pct = round(dismissals_n / balls_faced * 100, 2)) %&gt;%
  # Include those who have faced more than 200 balls total
  filter(total_balls_faced &gt;= 200) %&gt;%
  # Exclude balls beyond 6 - infrequent occurrences
  filter(ball_num_in_over &lt; 7)</code></pre>
<pre><code>## Joining, by = c(&quot;ball_num_in_over&quot;, &quot;striker&quot;)</code></pre>
<pre class="r"><code># Extract data for specific players
# Healy
dismissals_by_ball_number_summary_healy &lt;- dismissals_by_ball_number_summary %&gt;%
  filter(striker == &quot;AJ Healy&quot;)

# Mooney
dismissals_by_ball_number_summary_mooney &lt;- dismissals_by_ball_number_summary %&gt;%
  filter(striker == &quot;BL Mooney&quot;)

# Lanning
dismissals_by_ball_number_summary_lanning &lt;- dismissals_by_ball_number_summary %&gt;%
  filter(striker == &quot;MM Lanning&quot;)

# Perry
dismissals_by_ball_number_summary_perry &lt;- dismissals_by_ball_number_summary %&gt;%
  filter(striker == &quot;EA Perry&quot;)

# Devine
dismissals_by_ball_number_summary_devine &lt;- dismissals_by_ball_number_summary %&gt;%
  filter(striker == &quot;SFM Devine&quot;)

# Knight
dismissals_by_ball_number_summary_knight &lt;- dismissals_by_ball_number_summary %&gt;%
  filter(striker == &quot;HC Knight&quot;)</code></pre>
<pre class="r"><code>plot_features &lt;- list(
  coord_cartesian(ylim = c(0, 10)),
  theme_minimal(),
  theme(
    text = element_text(
      size = 18, family = &quot;roboto_con&quot;,
      colour = &quot;#FFFFFF&quot;),
    plot.title = element_text(family = &quot;staat&quot;, margin=margin(0,0,15,0)),
    plot.subtitle = element_text(family = &quot;staat&quot;, margin=margin(0,0,15,0)),
    plot.caption = element_markdown(size = NULL, margin=margin(15,0,0,0)),
    axis.text = element_text(colour = &quot;#FFFFFF&quot;),
    legend.position = &quot;none&quot;,
    panel.grid.major.y = element_line(linetype = &quot;dashed&quot;),
    panel.grid.major.x = element_blank(),
    panel.grid.minor = element_blank(),
    plot.background = element_rect(
      fill = paletteer_d(&quot;beyonce::X116&quot;)[3],
      colour = NA),
    panel.spacing = unit(2, &quot;lines&quot;),
    plot.margin = unit(c(0.5,0.5,0.5,0.5), &quot;cm&quot;))
  )

showtext_auto()

# Healy
p &lt;- ggplot(dismissals_by_ball_number_summary,
            aes(x = ball_num_in_over, y = dismissals_pct))
p &lt;- p + geom_boxplot(
  fill = &quot;#FFFFFF&quot;, colour = &quot;#FFFFFF&quot;, size = 1, alpha = 0.25,
  notch = TRUE, outlier.shape = NA, coef = 0)
p &lt;- p + geom_point(
  data = dismissals_by_ball_number_summary_healy,
  colour = paletteer_d(&quot;beyonce::X25&quot;)[5], size = 3)
p &lt;- p + labs(
  title = &quot;WBBL: % dismissals by ball number&quot;,
  subtitle = &quot;AJ Healy&quot;,
  x = NULL, y = NULL)
p &lt;- p + plot_features
p1 &lt;- p
# plot_dismissals_by_ball_num_healy &lt;- p

# Mooney
p &lt;- ggplot(dismissals_by_ball_number_summary,
            aes(x = ball_num_in_over, y = dismissals_pct))
p &lt;- p + geom_boxplot(
  fill = &quot;#FFFFFF&quot;, colour = &quot;#FFFFFF&quot;, size = 1, alpha = 0.25,
  notch = TRUE, outlier.shape = NA, coef = 0)
p &lt;- p + geom_point(
  data = dismissals_by_ball_number_summary_mooney,
  colour = paletteer_d(&quot;NineteenEightyR::miami1&quot;)[5], size = 3)
p &lt;- p + labs(
  subtitle = &quot;BL Mooney&quot;,
  x = NULL, y = NULL)
p &lt;- p + plot_features
p2 &lt;- p

# Lanning
p &lt;- ggplot(dismissals_by_ball_number_summary,
            aes(x = ball_num_in_over, y = dismissals_pct))
p &lt;- p + geom_boxplot(
  fill = &quot;#FFFFFF&quot;, colour = &quot;#FFFFFF&quot;, size = 1, alpha = 0.25,
  notch = TRUE, outlier.shape = NA, coef = 0)
p &lt;- p + geom_point(
  data = dismissals_by_ball_number_summary_lanning,
  colour = paletteer_d(&quot;beyonce::X93&quot;)[31], size = 3)
p &lt;- p + labs(
  subtitle = &quot;MM Lanning&quot;,
  x = NULL, y = NULL)
p &lt;- p + plot_features
p3 &lt;- p

# Perry
p &lt;- ggplot(dismissals_by_ball_number_summary,
            aes(x = ball_num_in_over, y = dismissals_pct))
p &lt;- p + geom_boxplot(
  fill = &quot;#FFFFFF&quot;, colour = &quot;#FFFFFF&quot;, size = 1, alpha = 0.25,
  notch = TRUE, outlier.shape = NA, coef = 0)
p &lt;- p + geom_point(
  data = dismissals_by_ball_number_summary_perry,
  colour = paletteer_d(&quot;beyonce::X25&quot;)[5], size = 3)
p &lt;- p + labs(
  subtitle = &quot;EA Perry&quot;,
  # caption = &quot;&quot;,
  x = NULL, y = NULL)
p &lt;- p + plot_features
p4 &lt;- p

# Devine
p &lt;- ggplot(dismissals_by_ball_number_summary,
            aes(x = ball_num_in_over, y = dismissals_pct))
p &lt;- p + geom_boxplot(
  fill = &quot;#FFFFFF&quot;, colour = &quot;#FFFFFF&quot;, size = 1, alpha = 0.25,
  notch = TRUE, outlier.shape = NA, coef = 0)
p &lt;- p + geom_point(
  data = dismissals_by_ball_number_summary_devine,
  colour = paletteer_d(&quot;NineteenEightyR::miami1&quot;)[5], size = 3)
p &lt;- p + labs(
  subtitle = &quot;SFM Devine&quot;,
  # caption = &quot;&quot;,
  x = NULL, y = NULL)
p &lt;- p + plot_features
p5 &lt;- p

# Knight
p &lt;- ggplot(dismissals_by_ball_number_summary,
            aes(x = ball_num_in_over, y = dismissals_pct))
p &lt;- p + geom_boxplot(
  fill = &quot;#FFFFFF&quot;, colour = &quot;#FFFFFF&quot;, size = 1, alpha = 0.25,
  notch = TRUE, outlier.shape = NA, coef = 0)
p &lt;- p + geom_point(
  data = dismissals_by_ball_number_summary_knight,
  colour = paletteer_d(&quot;LaCroixColoR::Lime&quot;)[2], size = 3)
p &lt;- p + labs(
  subtitle = &quot;HC Knight&quot;,
  caption = &quot;**Source:** Cricsheet.org // **Plot:** @jacquietran&quot;,
  x = NULL, y = NULL)
p &lt;- p + plot_features
p6 &lt;- p</code></pre>
<pre class="r"><code># Quilt the plots
quilt_dismissals_by_ball_number &lt;- (p1 + p2 + p3) / (p4 + p5 + p6)

# Display the quilted plot
quilt_dismissals_by_ball_number</code></pre>
<p><img src="/post/2021-11-10-wbbl-visualisations_files/figure-html/quilt_dismissals_by_ball_number-1.png" width="672" /></p>
<pre class="r"><code>showtext_auto(FALSE)</code></pre>
</div>
<div id="wiggly-bois" class="section level2">
<h2>Wiggly bois</h2>
<pre class="r"><code>wbbl_match_info %&gt;%
  filter(season == &quot;2021/22&quot;) %&gt;%
  select(
    match_id, winner, winner_runs, winner_wickets, method, outcome,
    eliminator) %&gt;%
  mutate(
    match_id = factor(match_id)) -&gt; wbbl07_match_info_tidy

wbbl_bbb %&gt;%
  filter(season == &quot;2021/22&quot;) %&gt;%
  tidyr::separate(ball, c(&quot;over_num_extracted&quot;, &quot;ball_num&quot;)) %&gt;%
  mutate(
    match_id = factor(match_id),
    over_num_numeric = as.numeric(over_num_extracted) + 1,
    runs_scored = runs_off_bat + extras,
    ball_num = as.numeric(ball_num),
    wicket_type = case_when(
      wicket_type == &quot;&quot; ~ NA_character_,
      TRUE              ~ wicket_type)) %&gt;%
  group_by(match_id, innings) %&gt;%
  mutate(
    temp_var = 1,
    balls_cumulative = cumsum(temp_var),
    runs_cumulative = cumsum(runs_scored),
    runs_total = max(runs_cumulative)) %&gt;%
  ungroup() %&gt;%
  select(-temp_var) %&gt;%
  left_join(., wbbl07_match_info_tidy) %&gt;%
  mutate(
    outcome_batting_team = case_when(
      outcome %in% c(&quot;no result&quot;, &quot;tie&quot;) ~ as.character(outcome),
      winner == batting_team             ~ &quot;won&quot;,
      TRUE                               ~ &quot;lost&quot;),
    outcome_bowling_team = case_when(
      outcome %in% c(&quot;no result&quot;, &quot;tie&quot;) ~ as.character(outcome),
      winner == bowling_team             ~ &quot;won&quot;,
      TRUE                               ~ &quot;lost&quot;)
    ) -&gt; wbbl07_bbb_tidy</code></pre>
<pre><code>## Joining, by = &quot;match_id&quot;</code></pre>
<pre class="r"><code>wbbl07_bbb_tidy %&gt;%
  # Exclude matches that ended with a Super Over (&quot;tie&quot;)
  # and matches that were called off (&quot;no result&quot;)
  filter(!outcome_batting_team %in% c(&quot;tie&quot;, &quot;no result&quot;)) %&gt;%
  group_by(match_id, innings) %&gt;%
  mutate(
    rolling_strike_rate = round(
      runs_cumulative / balls_cumulative * 100, 1),
    wicket_ball_num = case_when(
      !is.na(wicket_type) ~ balls_cumulative,
      TRUE                ~ NA_real_),
    wicket_strike_rate = case_when(
      !is.na(wicket_type) ~ rolling_strike_rate,
      TRUE                ~ NA_real_),
    innings_description = case_when(
      innings == 1 ~ &quot;Batting 1st&quot;,
      innings == 2 ~ &quot;Batting 2nd&quot;),
    bowling_team_short = word(bowling_team, -1),
    start_date_day = lubridate::day(start_date),
    start_date_month = lubridate::month(start_date),
    match_details = glue::glue(
      &quot;{innings_description} vs. {bowling_team_short} ({start_date_day}/{start_date_month})&quot;)) %&gt;%
  arrange(match_id, innings, balls_cumulative) %&gt;%
  mutate(
    match_details = factor(
      match_details, levels = unique(match_details)),
    outcome_batting_team = factor(
      outcome_batting_team, levels = c(&quot;won&quot;, &quot;lost&quot;)
    )) -&gt; team_strike_rate</code></pre>
<pre class="r"><code># Filter to Renegades&#39; innings only
team_strike_rate %&gt;%
  filter(
    str_detect(batting_team, &quot;Renegades&quot;)
    ) -&gt; team_strike_rate_renegades

showtext_auto()

# Build plot
p &lt;- ggplot(
  team_strike_rate_renegades,
  aes(x = balls_cumulative, y = rolling_strike_rate))
p &lt;- p + facet_wrap(~ match_details, ncol = 3)
p &lt;- p + geom_hline(
  yintercept = 100, linetype = &quot;dashed&quot;, colour = &quot;#CCCCCC&quot;)
p &lt;- p + geom_line(aes(colour = outcome_batting_team))
p &lt;- p + geom_point(
  aes(x = team_strike_rate_renegades$wicket_ball_num,
      y = team_strike_rate_renegades$wicket_strike_rate),
      colour = &quot;red&quot;, size = 1, alpha = 0.75)
p &lt;- p + labs(
  title = &quot;WBBL07: Melbourne Renegades - Team strike rate (games up to 7 Nov 2021)&quot;,
  x = &quot;Ball number in an innings&quot;, y = NULL,
  caption = &quot;**Source:** Cricsheet.org // **Plot:** @jacquietran&quot;)
p &lt;- p + scale_x_continuous(
  breaks = seq(0, 120, by = 30))
p &lt;- p + scale_color_manual(
  values = c(&quot;won&quot; = &quot;#4a8bad&quot;, &quot;lost&quot; = &quot;#AD4A8B&quot;),
  labels = c(&quot;Renegades won&quot;, &quot;Renegades lost&quot;))
p &lt;- p + coord_cartesian(ylim = c(0, 200))
p &lt;- p + theme_minimal()
p &lt;- p + theme(
  text = element_text(
    size = 18, family = &quot;roboto_con&quot;,
    colour = &quot;#FFFFFF&quot;),
  legend.position = &quot;top&quot;,
  legend.title = element_blank(),
  legend.key.size = unit(1.5, &quot;cm&quot;),
  legend.margin = margin(0, 0, 0, 0),
  legend.spacing.x = unit(0, &quot;cm&quot;),
  legend.spacing.y = unit(0, &quot;cm&quot;),
  plot.title = element_text(family = &quot;staat&quot;, margin=margin(0,0,15,0)),
  plot.caption = element_markdown(size = NULL, margin=margin(15,0,0,0)),
  strip.text = element_text(colour = &quot;#FFFFFF&quot;, size = 12),
  axis.text = element_text(colour = &quot;#FFFFFF&quot;),
  axis.title.x = element_text(margin=margin(15,0,0,0)),
  panel.grid.major.y = element_blank(),
  panel.grid.minor.y = element_blank(),
  panel.grid.major.x = element_line(
    colour = &quot;#203b60&quot;, linetype = &quot;dotted&quot;),
  panel.grid.minor.x = element_blank(),
  plot.background = element_rect(
      fill = paletteer_d(&quot;beyonce::X116&quot;)[3],
      colour = NA),
  panel.spacing = unit(2, &quot;lines&quot;),
  plot.margin = unit(c(0.5,0.5,0.5,0.5), &quot;cm&quot;))
plot_team_strike_rate_renegades &lt;- p

# Display plot
plot_team_strike_rate_renegades</code></pre>
<p><img src="/post/2021-11-10-wbbl-visualisations_files/figure-html/team_strike_rate_renegades-1.png" width="768" /></p>
<pre class="r"><code>showtext_auto(FALSE)</code></pre>
</div>
</div>
